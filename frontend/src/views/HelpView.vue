<template>
  <div class="help-view">
    <el-card class="help-card">
      <template #header>
        <div class="help-header">
          <h1>Руководство пользователя по методам предобработки данных</h1>
        </div>
      </template>
      
      <div class="help-content" v-html="renderedContent"></div>
    </el-card>
  </div>
</template>

<script>
import { defineComponent, ref, onMounted } from 'vue';
import { marked } from 'marked';

export default defineComponent({
  name: 'HelpView',
  
  setup() {
    const helpContent = ref(`
# Руководство пользователя по методам предобработки данных

## Введение
Данное приложение предоставляет удобный конструктор для предобработки данных перед построением прогнозных моделей. В этом руководстве описаны доступные методы преобразования данных, их назначение, принципы работы и примеры применения.

## Содержание
1. Обработка пропущенных значений
2. Обработка выбросов
3. Стандартизация данных
4. Кодирование категориальных переменных
5. Снижение размерности (PCA)
6. Лагирование переменных
7. Скользящие статистики
8. Извлечение компонентов даты
9. Обратное масштабирование

## 1. Обработка пропущенных значений

### Описание
Метод используется для обработки отсутствующих данных (NA, NULL) в наборе данных. Пропущенные значения могут искажать результаты анализа или делать невозможным применение некоторых алгоритмов.

### Параметры
- **Стратегия обработки**: 
  - *Заполнить средним* - заполняет пропуски средним значением по столбцу
  - *Заполнить медианой* - заполняет пропуски медианным значением (более устойчиво к выбросам)
  - *Заполнить модой* - заполняет пропуски наиболее часто встречающимся значением
  - *Удалить строки* - удаляет строки, содержащие пропущенные значения

- **Столбцы для обработки**: выберите столбцы, в которых нужно обработать пропуски

### Пример
Если в столбце "Доход" есть пропущенные значения, и вы выбрали стратегию "Заполнить средним", то все пропуски будут заменены на среднее значение дохода по всему набору данных.

### Когда применять
- Когда в данных есть пропуски, которые могут мешать анализу
- Когда используемые алгоритмы не поддерживают работу с пропущенными данными
- Перед применением методов моделирования, требующих полные данные

## 2. Обработка выбросов

### Описание
Выбросы - это аномальные значения, которые значительно отличаются от большинства наблюдений. Они могут искажать статистические показатели и снижать качество моделей.

### Параметры
- **Метод обнаружения выбросов**:
  - *Z-оценка* - определяет выбросы на основе стандартного отклонения от среднего
  - *Межквартильный размах (IQR)* - использует разницу между 1-м и 3-м квартилями для обнаружения выбросов

- **Порог для определения выбросов**: 
  - Для Z-оценки: значения, превышающие среднее на указанное число стандартных отклонений
  - Для IQR: значения, выходящие за пределы Q1-порог×IQR и Q3+порог×IQR

- **Столбцы для обработки**: выберите числовые столбцы для обнаружения выбросов

### Пример
Если в столбце "Возраст" есть значение 150, а большинство значений находится в диапазоне 20-80, то при использовании метода Z-оценки с порогом 3, это значение будет определено как выброс и заменено на граничное допустимое значение.

### Когда применять
- При наличии аномальных значений, искажающих статистику
- Перед обучением моделей, чувствительных к выбросам (например, линейная регрессия)
- Для повышения устойчивости и обобщающей способности моделей

## 3. Стандартизация данных

### Описание
Стандартизация приводит признаки к единому масштабу, что особенно важно для алгоритмов, чувствительных к масштабу данных.

### Параметры
- **Метод стандартизации**:
  - *Стандартизация* - преобразует данные так, чтобы среднее значение было 0, а стандартное отклонение - 1
  - *Мин-макс нормализация* - масштабирует данные в диапазон [0, 1]

- **Столбцы для обработки**: выберите числовые столбцы для стандартизации

### Пример
Исходные данные в столбце "Доход": [10000, 20000, 30000, 40000, 50000]
- После стандартизации: [-1.41, -0.71, 0, 0.71, 1.41]
- После мин-макс нормализации: [0, 0.25, 0.5, 0.75, 1]

### Когда применять
- Перед использованием алгоритмов, чувствительных к масштабу (метод k-ближайших соседей, метод опорных векторов, нейронные сети)
- Когда признаки имеют разные единицы измерения и диапазоны значений
- Для улучшения сходимости градиентных методов

## 4. Кодирование категориальных переменных

### Описание
Преобразует категориальные (текстовые или символьные) данные в числовой формат, необходимый для большинства алгоритмов машинного обучения.

### Параметры
- **Метод кодирования**:
  - *One-Hot кодирование* - создает бинарные столбцы для каждой категории
  - *Label кодирование* - присваивает категориям числовые метки

- **Столбцы для обработки**: категориальные столбцы для кодирования

### Пример
Исходные данные в столбце "Город": ["Москва", "Санкт-Петербург", "Москва", "Казань"]

One-Hot кодирование:
\`\`\`
Город_Москва: [1, 0, 1, 0]
Город_Санкт-Петербург: [0, 1, 0, 0]
Город_Казань: [0, 0, 0, 1]
\`\`\`

Label кодирование:
\`\`\`
Город: [0, 1, 0, 2]
\`\`\`

### Когда применять
- Для категориальных данных перед использованием алгоритмов, требующих числовые входные данные
- One-Hot для номинальных переменных (без естественного порядка)
- Label для порядковых переменных (с естественным порядком)

## 5. Снижение размерности (PCA)

### Описание
Метод главных компонент (PCA) уменьшает количество признаков за счет создания новых, являющихся линейными комбинациями исходных переменных. Это позволяет снизить размерность данных с минимальной потерей информации.

### Параметры
- **Количество компонент**: число новых признаков, которые будут созданы
- **Столбцы для обработки**: числовые столбцы для преобразования

### Пример
Если у вас есть 10 числовых признаков, которые сильно коррелируют между собой, PCA может сократить размерность до 2-3 главных компонент, сохраняя при этом большую часть вариативности данных.

### Когда применять
- Когда данные содержат много признаков, которые коррелируют между собой
- Для сокращения размерности данных и устранения мультиколлинеарности
- При визуализации многомерных данных в двумерном или трехмерном пространстве
- Для ускорения обучения моделей путем сокращения числа входных признаков

## 6. Лагирование переменных

### Описание
Создает новые признаки на основе предыдущих значений временного ряда. Это помогает алгоритмам машинного обучения улавливать временные зависимости.

### Параметры
- **Целевая переменная**: временной ряд, для которого нужно создать лаги
- **Периоды лагирования**: на сколько шагов назад смещать значения (например, 1, 2, 3 дня)
- **Экзогенные переменные для лагирования**: другие временные ряды, которые могут влиять на целевую переменную

### Пример
Если у вас есть временной ряд цен акций, и вы хотите предсказать цену на следующий день, вы можете создать лаги для 1, 2 и 3 дней:

\`\`\`
Дата       | Цена | Цена_lag_1 | Цена_lag_2 | Цена_lag_3
-----------|------|------------|------------|------------
01.01.2023 | 100  | NULL       | NULL       | NULL
02.01.2023 | 102  | 100        | NULL       | NULL
03.01.2023 | 101  | 102        | 100        | NULL
04.01.2023 | 103  | 101        | 102        | 100
05.01.2023 | 105  | 103        | 101        | 102
\`\`\`

### Когда применять
- При анализе и прогнозировании временных рядов
- Для учета предыдущих значений при предсказании будущих
- Когда текущее значение переменной зависит от её прошлых значений

## 7. Скользящие статистики

### Описание
Рассчитывает различные статистические показатели (среднее, стандартное отклонение и др.) в скользящем окне фиксированного размера для временных рядов.

### Параметры
- **Целевая переменная**: временной ряд для расчета статистик
- **Размер окна**: количество наблюдений в окне
- **Статистики для расчета**: показатели для вычисления (среднее, стандартное отклонение, минимум, максимум)

### Пример
Для временного ряда цен акций [100, 102, 101, 103, 105, 104] и окна размером 3:

\`\`\`
Дата       | Цена | Цена_rolling_mean_3 | Цена_rolling_std_3
-----------|------|---------------------|------------------
01.01.2023 | 100  | NULL                | NULL
02.01.2023 | 102  | NULL                | NULL
03.01.2023 | 101  | 101.0               | 1.0
04.01.2023 | 103  | 102.0               | 1.0
05.01.2023 | 105  | 103.0               | 2.0
06.01.2023 | 104  | 104.0               | 1.0
\`\`\`

### Когда применять
- Для сглаживания временных рядов и выявления трендов
- При создании признаков для моделей прогнозирования
- Для учета локальной динамики временного ряда

## 8. Извлечение компонентов даты

### Описание
Извлекает различные компоненты из столбцов с датами (год, месяц, день недели и т.д.), которые могут быть полезны для выявления сезонности и периодичности.

### Параметры
- **Столбцы с датами для обработки**: столбцы типа datetime
- **Компоненты даты для извлечения**: год, месяц, квартал, день недели, день месяца, день года, неделя года

### Пример
Из столбца "Дата" со значением "2023-06-15" можно извлечь:
\`\`\`
Дата_год: 2023
Дата_месяц: 6
Дата_квартал: 2
Дата_день_недели: 4 (четверг)
Дата_день_месяца: 15
Дата_день_года: 166
Дата_неделя_года: 24
\`\`\`

### Когда применять
- Для анализа данных с временной составляющей
- При поиске сезонных паттернов и периодичности
- Для создания признаков, отражающих временные аспекты данных

## 9. Обратное масштабирование

### Описание
Отменяет эффекты стандартизации или нормализации, возвращая данные к исходному масштабу. Это полезно, когда требуется интерпретировать результаты в исходных единицах измерения.

### Параметры
- **Столбцы для преобразования**: выберите столбцы для обратного масштабирования
- **Параметры масштабирования**: параметры, использованные при первоначальном масштабировании (среднее, стандартное отклонение или мин/макс значения)

### Пример
Если данные были стандартизованы:
- Исходные данные: [10000, 20000, 30000, 40000, 50000]
- Стандартизованные: [-1.41, -0.71, 0, 0.71, 1.41]

После обратного масштабирования получаем исходные значения: [10000, 20000, 30000, 40000, 50000]

### Когда применять
- После применения масштабирования и прогнозирования, когда нужно вернуть результаты к исходному масштабу
- Для интерпретации результатов в понятных единицах измерения
- При визуализации данных в исходном масштабе

## Рекомендации по использованию

1. **Порядок применения методов имеет значение**. Например, обработка пропусков должна предшествовать масштабированию.

2. **Используйте предпросмотр результатов** перед применением методов к полному набору данных.

3. **Сохраняйте параметры масштабирования** для последующего применения обратного масштабирования.

4. **Для временных рядов** сначала примените методы извлечения компонентов даты и лагирования, а затем другие преобразования.

5. **При работе с категориальными данными** сначала закодируйте их, а затем применяйте другие методы.

## Советы по решению проблем

- **Если результаты странные или непонятные**, проверьте порядок применения методов и их параметры.

- **При ошибках в процессе обработки** проверьте соответствие типов данных требуемым для метода.

- **Для временных рядов с пропусками** рекомендуется сначала заполнить пропуски, а затем применять методы лагирования и скользящих статистик.

- **Экспортируйте метаданные масштабирования** после применения стандартизации, чтобы потом можно было применить обратное масштабирование.
    `);

    const renderedContent = ref('');

    onMounted(() => {
      renderedContent.value = marked(helpContent.value);
    });

    return {
      renderedContent
    };
  }
});
</script>

<style scoped>
.help-view {
  max-width: 1200px;
  margin: 0 auto;
  padding: 20px;
}

.help-card {
  margin-bottom: 20px;
}

.help-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.help-content {
  padding: 20px 0;
}

/* Стили для Markdown контента */
.help-content :deep(h1) {
  font-size: 28px;
  font-weight: bold;
  margin-bottom: 20px;
  color: #303133;
}

.help-content :deep(h2) {
  font-size: 22px;
  font-weight: bold;
  margin-top: 30px;
  margin-bottom: 15px;
  color: #409EFF;
  border-bottom: 1px solid #EBEEF5;
  padding-bottom: 8px;
}

.help-content :deep(h3) {
  font-size: 18px;
  font-weight: bold;
  margin-top: 25px;
  margin-bottom: 15px;
  color: #606266;
}

.help-content :deep(ul), .help-content :deep(ol) {
  padding-left: 20px;
  margin: 15px 0;
}

.help-content :deep(li) {
  margin-bottom: 8px;
}

.help-content :deep(p) {
  line-height: 1.6;
  margin-bottom: 15px;
  color: #606266;
}

.help-content :deep(pre) {
  background-color: #f5f7fa;
  padding: 15px;
  border-radius: 4px;
  overflow-x: auto;
  margin: 15px 0;
}

.help-content :deep(code) {
  font-family: monospace;
  background-color: #f5f7fa;
  padding: 2px 4px;
  border-radius: 3px;
}
</style>